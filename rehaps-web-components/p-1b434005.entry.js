import{r as s,c as t,h as i,g as e}from"./p-bbd3fc13.js";import{A as r}from"./p-9d5c03f4.js";import{R as h}from"./p-47d66f75.js";const o=class{constructor(i){s(this,i),this.beforeChangeEvent=t(this,"beforeChange",7),this.changeEvent=t(this,"changed",7),this.actions=["goTo"],this.subscribedEvents=[],this.autoSlideCoroutine=null,this.actionKeyPrefix=h.RWC_ACTION_PREFIX,this.rwcKey=this.actionKeyPrefix+"-"+h.getLastComponentId(),this.defaultSlide=0,this.animateTransition=!0,this.mode="fade",this.animationSpeed=300,this.autoSlide=!1,this.autoSlideDelay=5e3,this.activeSlide=0}get currentSlideContainerOffset(){var s;return Number.parseFloat((null===(s=this.slideContainer)||void 0===s?void 0:s.style.left)||getComputedStyle(this.slideContainer).left)}componentWillLoad(){this.activeSlide=this.defaultSlide}componentDidLoad(){this.init()}disconnectedCallback(){clearInterval(this.autoSlideCoroutine),this.removeEventListeners()}init(){this.slides=this.slideContainer.assignedElements().map((s=>r.castToAnimatedElement(s))),this.initDefaultSlide(),this.initGoToEventListeners(),clearInterval(this.autoSlideCoroutine),this.autoSlide&&(this.initAutoSlide(),this.initSlidePauseEvents())}initDefaultSlide(){if(this.slides[this.activeSlide].style.display="block","carousel"===this.mode){const s=-this.slides[this.activeSlide].offsetLeft;this.slideWrapper.style.margin=`0 0 0 ${s}px`,this.slideWrapper.style.setProperty("--_progress",s.toString())}this.slides[this.activeSlide].classList.add(o.ACTIVE_SLIDE_CLASS)}initAutoSlide(){clearInterval(this.autoSlideCoroutine),this.autoSlideCoroutine=setInterval((()=>{this.goTo(this.activeSlide>=this.slides.length-1?0:this.activeSlide+1)}),this.autoSlideDelay)}initSlidePauseEvents(){this.root.addEventListener("mouseenter",(()=>{clearInterval(this.autoSlideCoroutine)})),this.root.addEventListener("mouseleave",(()=>{this.initAutoSlide()}))}async goTo(s){let t=null;s instanceof CustomEvent&&(t=s.target,s=Number.parseInt(s.detail.next)),this.activeSlide!==s&&(this.initAutoSlide(),this.beforeChangeEvent.emit({originalTarget:t,next:s,previous:this.activeSlide}),this.slides.forEach((s=>{s.classList.remove(o.ACTIVE_SLIDE_CLASS)})),this.animateTransition?await this.animateSlideContainer(s)&&this.setActiveSlide(s):this.setActiveSlide(s))}async animateSlideContainer(s){switch(this.mode){case"carousel":return this.handleCarouselAnimation(s);default:return this.handleFadeOutInAnimation(s)}}async handleCarouselAnimation(s){const t=this.slideWrapper.offsetLeft-this.slides[this.activeSlide].offsetLeft,i=this.slideWrapper.offsetLeft-this.slides[s].offsetLeft;return this.slideWrapper.animation.start({keyframes:[{"--_progress":`${t}`,marginLeft:`${t}px`},{"--_progress":`${i}`,marginLeft:`${i}px`}],options:{duration:this.animationSpeed,fill:"forwards"},progressProperty:"--_progress"})}async handleFadeOutInAnimation(s){const t=Number.parseFloat(this.slideWrapper.style.getPropertyValue("--_progress"))||0;return this.slides.forEach((s=>{s.style.display=""})),t<50?(this.slides[this.activeSlide].style.display="block",this.slideWrapper.style.display="block",new Promise((async t=>{const i=this.slideWrapper.animation.start({keyframes:[{"--_progress":0,opacity:1},{"--_progress":50,opacity:0}],options:{duration:this.animationSpeed/2,fill:"forwards"},progressProperty:"--_progress"});await i?(this.slides[this.activeSlide].style.display="none",t(this.handleFadeInAnimation(s))):t(!1)}))):(this.slides[this.activeSlide].style.display="none",this.handleFadeInAnimation(s))}async handleFadeInAnimation(s){return this.slides[s].style.display="block",this.slideWrapper.animation.start({keyframes:[{"--_progress":50,opacity:"0",display:"block"},{"--_progress":100,opacity:"1",display:"block"}],options:{duration:this.animationSpeed/2,fill:"forwards"},progressProperty:"--_progress"})}setActiveSlide(s){this.animateTransition?"fade"===this.mode&&this.slideWrapper.style.setProperty("--_progress",""):"fade"===this.mode?(this.slides[this.activeSlide].style.display="none",this.slides[s].style.display="block"):this.slideWrapper.style.marginLeft=this.slideWrapper.offsetLeft-this.slides[s].offsetLeft+"px",this.slides[s].classList.add(o.ACTIVE_SLIDE_CLASS),this.changeEvent.emit({originalTarget:this.element,next:s,previous:this.activeSlide}),this.activeSlide=s}initGoToEventListeners(){h.bindRWCActions(this,this.actions,this.actionKeyPrefix,this.rwcKey,"beforeChange")}removeEventListeners(){h.removeEventListeners(this)}render(){return i("div",{class:{container:!0,animate:this.animateTransition,[this.mode]:!0},ref:s=>this.root=s},i("div",{class:"slide-container",ref:s=>this.slideWrapper=r.castToAnimatedElement(s)},i("div",{class:"slide-flex"},i("slot",{ref:s=>this.slideContainer=s}))))}get element(){return e(this)}};o.ACTIVE_SLIDE_CLASS="active",o.style=".container{width:100%;overflow-x:hidden;position:relative}.container.carousel .slide-flex{display:flex;flex-direction:row}.container.carousel .slide-flex>::slotted(*){display:block;flex-basis:100%;flex-shrink:0;flex-grow:0}.slide-container{width:100%}.slide-flex>::slotted(*){display:none}";export{o as rwc_carousel}